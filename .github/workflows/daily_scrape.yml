name: Auto Scraper Saham

on:
  workflow_dispatch:

jobs:
  scrape-saham:
    runs-on: ubuntu-latest
    steps:
      - name: Ambil Kode
        uses: actions/checkout@v3

      - name: Siapkan Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Chrome
        uses: browser-actions/setup-chrome@latest

      - name: Install Library
        run: pip install -r requirements.txt

      - name: Jalankan Robot
        env:
          MONGO_URI: ${{ secrets.MONGO_URI }}
          SIGNALSAHAM_EMAIL: ${{ secrets.SIGNALSAHAM_EMAIL }}
          SIGNALSAHAM_PASSWORD: ${{ secrets.SIGNALSAHAM_PASSWORD }}
          HEADLESS_MODE: 'true'
          LINKS_FILE: link-name-stock.txt
          LINKS_LIMIT: '5'
          SKIP_EXISTING: 'false'
          RATE_LIMIT_MS: '800'
          REFRESH_RETRY: 'true'
          UPDATE_MODE: 'append'
        run: python scraper.py
